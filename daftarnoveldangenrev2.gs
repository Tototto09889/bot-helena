const daftarNovel = {
    "#": [
        {
            judul: "10-nen Goshi no HikiNEET",
            keyword: "10-nen",
            genre: "Isekai, Fantasy",
            sinopsis: "Kamar tidurku terhubung ke dunia lain!? Tiba-tiba rumah kontrakan NEET berusia 30 tahun itu berpindah ke dunia lain."
        }
         ],
    "A": [
        {
            judul: "Arifureta Shokugyou de Sekai Saikyou",
            keyword: "arifureta",
            genre: "Isekai, Action, Fantasy",
            sinopsis: "Di kelas yang dipenuhi siswa bermasalah, Hajime Nagumo adalah orang biasa-biasa saja. Namun, saat kelas tersebut dipanggil ke dunia lain, Hajime mendapati dirinya tidak hanya lemah tapi juga terperangkap di ruang bawah tanah yang mengerikan. Akankah dia bertahan hidup di dunia yang penuh monster dan dewa?"
        },
        {
            judul: "Absolute Duo",
            keyword: "absolute duo",
            genre: "Action, Ecchi, Harem, School, Supernatural",
            sinopsis: "Kisah ini berlatar di sebuah sekolah menengah atas khusus, Akademi Koryo, di mana para siswa yang memiliki 'Blaze' â€” senjata yang merupakan manifestasi dari jiwa mereka â€” berpasangan untuk bertarung dan belajar bersama sebagai 'Duo' dengan tujuan menjadi yang terkuat."
        },
         ],
    "B": [
        {
            judul: "Black Bullet",
            keyword: "black bullet",
            genre: "Action, Sci-Fi, Seinen",
            sinopsis: "Di masa depan yang dekat, umat manusia, yang dihancurkan oleh parasit virus 'Gastrea', telah diasingkan ke wilayah kecil dan hidup dalam keputusasaan, berdampingan dengan teror. Di dunia kegelapan ini â€” Rentaro, seorang anak laki-laki yang memiliki kekuatan super dan Enju, seorang gadis muda. Bersama-sama, mereka akan terus berjuang."
        }
    ],
    "C": [
        {
            judul: "Classroom of the Elite",
            keyword: "classroom",
            genre: "School, Slice of Life, Psychological",
            sinopsis: "Sekolah Menengah Lanjutan Tokyo Metropolitan Koudo Ikusei terlihat seperti surga, tetapi kenyataannya, ini adalah sekolah meritokrasi yang kejam. Di Kelas 1-D, Kiyotaka Ayanokoji menemukan ketidakpedulian dan ketidakmampuan sekolah untuk menempatkan siswa dengan nilai rendah. Bersama Suzune Horikita, mereka mencoba mengubah situasi mereka."
        }
    ],
    "D": [
        {
            judul: "Date A Live",
            keyword: "date a live",
            genre: "Sci-Fi, Harem, Romance",
            sinopsis: "Shido Itsuka, seorang siswa SMA biasa, bertemu dengan seorang gadis misterius di pusat ledakan luar angkasa. Ternyata, gadis itu adalah 'Spirit' â€” makhluk luar biasa yang menyebabkan gempa luar angkasa. Untuk menyelamatkan dunia, Shido harus berkencan dengan para Spirit dan membuat mereka jatuh cinta padanya."
        }
    ],
    "E": [
        {
            judul: "Erased",
            keyword: "erased",
            genre: "Mystery, Psychological, Supernatural",
            sinopsis: "Satoru Fujinuma memiliki kemampuan untuk kembali ke masa lalu sesaat untuk mencegah kecelakaan dan tragedi. Ketika ibunya dibunuh, kemampuan Satoru tiba-tiba membawanya kembali ke delapan belas tahun yang lalu dan dia sekarang menjadi siswa kelas lima. Dalam masa kecilnya, dia harus mencegah serangkaian penculikan yang merenggut nyawa teman-teman sekelasnya."
        }
    ],
    "F": [
        {
            judul: "Fate/Zero",
            keyword: "fate zero",
            genre: "Action, Supernatural, Fantasy",
            sinopsis: "Fate/Zero berlatar sepuluh tahun sebelum Fate/stay night, menceritakan kisah Perang Cawan Suci Keempat di Kota Fuyuki. Perang Cawan Suci adalah kompetisi antara tujuh magus, yang disebut Master, yang memanggil Roh Heroik, yang disebut Servant, untuk bertarung demi mereka untuk Cawan Suci, yang merupakan artefak mahakuasa yang dapat mengabulkan keinginan apa pun dari pemenang."
        }
    ],
    "G": [
        {
            judul: "Goblin Slayer",
            keyword: "goblin slayer",
            genre: "Action, Fantasy, Adventure",
            sinopsis: "Di dunia fantasi, seorang petualang wanita muda bergabung dengan kelompok petualang untuk pertama kalinya. Namun, tanpa persiapan, mereka segera bertemu dengan goblin dan semua kecuali dia dibantai. Goblin Slayer muncul untuk menyelamatkannya, seorang pria yang mendedikasikan hidupnya untuk pemberantasan semua goblin dengan segala cara."
        }
    ],
    "H": [
        {
            judul: "High School DxD",
            keyword: "high school dxd",
            genre: "Action, Harem, Comedy",
            sinopsis: "High School DxD berkisah tentang Issei Hyodo, seorang siswa mesum kelas dua SMA yang selalu mengintip. Kehidupan normal Issei berubah ketika dia dikencani oleh seorang gadis bernama Yuma Amano, yang ternyata adalah malaikat jatuh yang membunuhnya. Issei dihidupkan kembali sebagai iblis oleh Rias Gremory, iblis tingkat tinggi, dan mulai bekerja sebagai bawahannya."
        }
    ],
    "I": [
        {
            judul: "In Another World With My Smartphone",
            keyword: "smartphone",
            genre: "Isekai, Harem, Comedy",
            sinopsis: "Setelah secara tidak sengaja terbunuh oleh Tuhan, Touya Mochizuki dihidupkan kembali di dunia fantasi. Sebagai permintaan maaf, Tuhan mengabulkan satu keinginan Touya dan mengizinkannya untuk membawa ponsel cerdasnya ke dunia baru. Dalam kehidupan keduanya, Touya menjalin pertemanan dengan banyak orang penting, saat ia melakukan perjalanan dari satu negara ke negara lain, menyelesaikan masalah, dan menikmati kehidupan dunia barunya."
        }
    ],
    "J": [
        {
            judul: "Konosuba",
            keyword: "konosuba",
            genre: "Isekai, Comedy, Fantasy",
            sinopsis: "Kazuma Satou, seorang NEET SMA Jepang dan hikikomori, meninggal setelah kecelakaan lalu lintas. Dia bertemu dengan seorang dewi bernama Aqua, yang menawarkan untuk menghidupkannya kembali di dunia fantasi â€” tetapi dia dapat membawa satu barang bersamanya. Setelah Kazuma memilih Aqua sendiri, mereka dipindahkan ke dunia fantasi bergaya MMORPG dan memulai petualangan mereka bersama."
        }
    ],
    "K": [
        {
            judul: "Kakegurui",
            keyword: "kakegurui",
            genre: "Psychological, Drama, Mystery",
            sinopsis: "Hyakkaou Private Academy adalah sekolah bergengsi untuk orang kaya dan memiliki hak istimewa, dengan banyak siswa yang merupakan anak-anak dari orang terkaya di dunia. Di sekolah tersebut, hierarki siswa ditentukan oleh kontribusi mereka pada dana sekolah, yang didorong oleh perjudian taruhan tinggi. Yumeko Jabami, seorang siswa pindahan misterius, menunjukkan bahwa dia hanya berjudi untuk sensasi, bukan keuntungan finansial, yang dengan cepat mengganggu hierarki sekolah."
        }
    ],
    "L": [
        {
            judul: "Log Horizon",
            keyword: "log horizon",
            genre: "Game, Isekai, Fantasy",
            sinopsis: "Ketika update ekspansi kesebelas untuk game online multipemain Elder Tale dirilis, tiga puluh ribu gamer Jepang yang masuk terkejut menemukan diri mereka dibawa ke dunia game yang baru diubah. Di antara mereka adalah mahasiswa pascasarjana Shiroe, yang harus belajar hidup di dunia baru. Shiroe mencoba untuk bertahan hidup, dan mulai memahami dunia baru meskipun ada batasan menjadi dunia game."
        }
    ],
    "M": [
        {
            judul: "Mushoku Tensei",
            keyword: "mushoku tensei",
            genre: "Isekai, Drama, Fantasy",
            sinopsis: "Seorang pria berusia 34 tahun yang tidak disebutkan namanya, NEET dan hikikomori, diusir dari rumah setelah kematian orang tuanya. Setelah merenungkan hidupnya yang gagal, ia melihat truk yang melaju dengan cepat menuju sekelompok remaja dan mencoba menyelamatkan mereka, hanya untuk terbunuh dalam proses tersebut. Terbangun sebagai bayi Rudeus Greyrat di dunia fantasi dengan pedang dan sihir, ia bersumpah bahwa ia akan menjalani kehidupan barunya dengan tidak menyesal."
        }
    ],
    "N": [
        {
            judul: "No Game No Life",
            keyword: "no game no life",
            genre: "Game, Comedy, Supernatural",
            sinopsis: "Sora dan Shiro adalah saudara kandung NEET hikikomori yang terkenal di dunia game online sebagai Blank, identitas pemain tak terkalahkan. Suatu hari, mereka dipanggil ke dunia lain oleh Dewa Permainan. Di sana, Tuhan telah melarang perang dan menyatakan bahwa semuanya akan diputuskan oleh permainan â€” bahkan batas negara. Sora dan Shiro harus menyelamatkan umat manusia dunia lain dari kepunahan."
        }
    ],
    "O": [
        {
            judul: "Overlord",
            keyword: "overlord",
            genre: "Game, Isekai, Action",
            sinopsis: "Yggdrasil adalah game online multipemain yang populer yang suatu hari diam-diam ditutup. Namun, protagonis Momonga memutuskan untuk tidak logout. Momonga kemudian diangkut ke dunia game dan menjadi kerangka penyihir 'terkuat' bernama Momonga. Dunia ini sangat berbeda dari yang pernah ia ketahui sebagai game, dan NPC mulai merasakan emosi. Tanpa teman, keluarga, atau tempat di masyarakat, Momonga berusaha untuk mengambil alih dunia game baru."
        }
    ],
    "P": [
        {
            judul: "Parasyte",
            keyword: "parasyte",
            genre: "Sci-Fi, Horror, Action",
            sinopsis: "Shinichi Izumi adalah seorang siswa SMA berusia tujuh belas tahun yang tinggal di Tokyo. Suatu malam, makhluk parasit mirip cacing yang disebut Parasit menyerbu Bumi, mulai mengambil alih otak manusia dengan memasuki telinga atau hidung mereka. Salah satu Parasit mencoba merangkak ke lengan kanan Shinichi saat dia tidur, tetapi gagal karena Shinichi terbangun, dan Parasit itu berakhir hanya parasit di tangan kanannya. Karena itu, keduanya mempertahankan intelek dan kepribadian masing-masing. Saat Parasit lain menyerang manusia, Shinichi dan Migi bekerja sama untuk bertahan hidup."
        }
    ],
    "Q": [
        {
            judul: "The Quintessential Quintuplets",
            keyword: "quintuplets",
            genre: "Harem, Comedy, Romance",
            sinopsis: "Fuutarou Uesugi adalah siswa SMA miskin yang membenci orang kaya, tetapi menjalani kehidupan yang tenang untuk menghidupi keluarganya. Suatu hari, ia mendapat kesempatan untuk mengajar sebagai tutor pribadi dengan bayaran yang sangat tinggi. Dia menemukan bahwa murid-muridnya adalah teman sekelasnya â€” dan lebih jauh lagi, kembar lima identik dari keluarga kaya Nakano, tetapi gadis-gadis itu semuanya memiliki nilai yang buruk."
        }
    ],
    "R": [
        {
            judul: "Re:Zero",
            keyword: "re zero",
            genre: "Isekai, Psychological, Thriller",
            sinopsis: "Natsuki Subaru adalah seorang NEET hikikomori yang tiba-tiba menemukan dirinya diangkut ke dunia lain saat dalam perjalanan pulang dari toko serba ada. Dengan tidak banyak waktu untuk bereaksi, dia diserang oleh bandit dan dipukuli hingga babak belur. Diselamatkan oleh seorang gadis berambut perak setengah elf bernama Satella, dia bekerja sama dengannya untuk membalas budi. Ketika mereka diserang oleh musuh misterius, Subaru dan Satella terbunuh."
        }
    ],
    "S": [
        {
            judul: "Sword Art Online",
            keyword: "sword art online",
            genre: "Game, Action, Romance",
            sinopsis: "Pada tahun 2022, game virtual reality multipemain online besar (VRMMORPG) Sword Art Online telah dirilis. Dengan NerveGear, helm VR yang menstimulasi panca indera pengguna melalui otak mereka, pemain dapat mengalami dan mengendalikan karakter dalam game mereka dengan pikiran mereka. Namun, terjadi kerusakan pada game tersebut dan para pemain terjebak di dalamnya jika mereka ingin keluar dari game tersebut, mereka harus menyelesaikan semua 100 lantai Aincrad â€” menara baja, penuh monster."
        },
        {
            judul: "Steins;Gate",
            keyword: "steins gate",
            genre: "Sci-Fi, Psychological, Thriller",
            sinopsis: "Steins;Gate berkisah tentang sekelompok teman yang dapat mengirim pesan teks ke masa lalu dan mengubah masa kini. Rintaro Okabe adalah seorang mahasiswa tingkat pertama yang ambisius yang menggambarkan dirinya sebagai ilmuwan gila dan mendirikan 'Laboratorium Gadget Masa Depan', di mana ia bertujuan untuk menciptakan penemuan futuristik. Suatu hari, mereka secara tidak sengaja menemukan bahwa microwave mereka dapat mengirim pesan teks ke masa lalu. Rintaro dan teman-temannya mulai bereksperimen dengan 'mesin waktu' mereka, mengirim pesan ke masa lalu dan mengubah masa kini. Namun, mereka segera menemukan bahwa mengubah masa lalu dapat memiliki konsekuensi yang tidak terduga."
        }
    ],
    "T": [
        {
            judul: "The Rising of the Shield Hero",
            keyword: "shield hero",
            genre: "Isekai, Action, Fantasy",
            sinopsis: "Naofumi Iwatani dipanggil ke dunia lain untuk menjadi Pahlawan Perisai. Digambarkan sebagai pahlawan terlemah, tidak lama kemudian Naofumi mendapati dirinya sendirian, tanpa uang, dan dikhianati. Karena tidak memiliki tempat untuk berpaling, dia harus menjadi Pahlawan Perisai legendaris dan menyelamatkan dunia."
        }
    ],
    "U": [],
    "V": [],
    "W": [],
    "X": [],
    "Y": [],
    "Z": []
};

// Fungsi untuk membuat daftar genre unik dan terurut dari daftar novel
function getUniqueGenres() {
    let genres = new Set();
    for (const huruf in daftarNovel) {
        daftarNovel[huruf].forEach(novel => {
            novel.genre.split(', ').forEach(genre => genres.add(genre.trim()));
        });
    }
    return Array.from(genres).sort();
}

// Fungsi untuk membuat keyboard menu genre dengan pagination
function getMenuGenreKeyboard(page = 1) {
    let genres = getUniqueGenres();
    const genresPerPage = 10;
    const start = (page - 1) * genresPerPage;
    const end = start + genresPerPage;
    const paginatedGenres = genres.slice(start, end);
    const totalPages = Math.ceil(genres.length / genresPerPage);

    let keyboard = {
        inline_keyboard: []
    };
    let row = [];
    paginatedGenres.forEach(genre => {
        row.push({ text: genre, callback_data: "genre_list_" + genre + "_page_1" });
        if (row.length === 3) {
            keyboard.inline_keyboard.push(row);
            row = [];
        }
    });
    if (row.length > 0) {
        keyboard.inline_keyboard.push(row);
    }

    let paginationRow = [];
    if (page > 1) {
        paginationRow.push({ text: "Â« Sebelumnya", callback_data: `daftar_genre_page_${page - 1}` });
    }
    if (page < totalPages) {
        paginationRow.push({ text: "Selanjutnya Â»", callback_data: `daftar_genre_page_${page + 1}` });
    }
    if (paginationRow.length > 0) {
        keyboard.inline_keyboard.push(paginationRow);
    }

    keyboard.inline_keyboard.push([{ text: "Kembali ke Menu Fitur ğŸ¤¡", callback_data: "kembali_ke_fitur" }]);
    return keyboard;
}

// Fungsi untuk membuat keyboard daftar novel per genre dengan pagination (fungsi ini sudah benar dan tidak perlu diubah)
function getNovelListGenreKeyboard(genre, page = 1) {
    let tombolNovel = [];
    let novelGenreList = [];
    for (const huruf in daftarNovel) {
        daftarNovel[huruf].forEach(novel => {
            if (novel.genre.includes(genre)) {
                novelGenreList.push(novel);
            }
        });
    }

    const novelsPerPage = 8;
    const start = (page - 1) * novelsPerPage;
    const end = start + novelsPerPage;
    const paginatedNovels = novelGenreList.slice(start, end);
    const totalPages = Math.ceil(novelGenreList.length / novelsPerPage);

    paginatedNovels.forEach(novel => {
        tombolNovel.push([{ text: novel.judul, callback_data: "novel_page_" + novel.judul + "_genre_" + genre + "_page_1" }]); // Menambahkan info genre ke callback
    });

    let paginationRow = [];
    if (totalPages > 1) {
        paginationRow.push({ text: "Â« Sebelumnya", callback_data: `genre_list_${genre}_page_${page - 1}` });
    }
    if (page < totalPages) {
        paginationRow.push({ text: "Selanjutnya Â»", callback_data: `genre_list_${genre}_page_${page + 1}` });
    }
    if (paginationRow.length > 0) {
        tombolNovel.push(paginationRow);
    }

    tombolNovel.push([{ text: "Kembali ke Menu Daftar Genre ğŸ­", callback_data: "daftar_genre" }]); // Tombol Kembali ke Menu Genre
    return { inline_keyboard: tombolNovel };
}


function getMenuNovelKeyboard() {
    let keyboard = {
        inline_keyboard: [
            [
                { text: "A", callback_data: "novel_list_A_page_1" },
                { text: "B", callback_data: "novel_list_B_page_1" },
                { text: "C", callback_data: "novel_list_C_page_1" },
                { text: "D", callback_data: "novel_list_D_page_1" },
                { text: "E", callback_data: "novel_list_E_page_1" },
                { text: "F", callback_data: "novel_list_F_page_1" },
                { text: "G", callback_data: "novel_list_G_page_1" },
            ],
            [
                { text: "H", callback_data: "novel_list_H_page_1" },
                { text: "I", callback_data: "novel_list_I_page_1" },
                { text: "J", callback_data: "novel_list_J_page_1" },
                { text: "K", callback_data: "novel_list_K_page_1" },
                { text: "L", callback_data: "novel_list_L_page_1" },
                { text: "M", callback_data: "novel_list_M_page_1" },
                { text: "N", callback_data: "novel_list_N_page_1" },
            ],
            [
                { text: "O", callback_data: "novel_list_O_page_1" },
                { text: "P", callback_data: "novel_list_P_page_1" },
                { text: "Q", callback_data: "novel_list_Q_page_1" },
                { text: "R", callback_data: "novel_list_R_page_1" },
                { text: "S", callback_data: "novel_list_S_page_1" },
                { text: "T", callback_data: "novel_list_T_page_1" },
                { text: "U", callback_data: "novel_list_U_page_1" },
            ],
            [
                { text: "V", callback_data: "novel_list_V_page_1" },
                { text: "W", callback_data: "novel_list_W_page_1" },
                { text: "X", callback_data: "novel_list_X_page_1" },
                { text: "Y", callback_data: "novel_list_Y_page_1" },
                { text: "Z", callback_data: "novel_list_Z_page_1" },
                { text: "#", callback_data: "novel_list_#_page_1" },
            ],
            [
                { text: "Kembali ke Menu Fitur ğŸ¤¡", callback_data: "kembali_ke_fitur" },
            ]
        ]
    };
    return keyboard;
}

function getNovelListKeyboard(huruf, page = 1) {
    let novels = daftarNovel[huruf] || [];
    const novelsPerPage = 8;
    const start = (page - 1) * novelsPerPage;
    const end = start + novelsPerPage;
    const paginatedNovels = novels.slice(start, end);
    const totalPages = Math.ceil(novels.length / novelsPerPage);

    let tombolNovel = paginatedNovels.map(novel => [{ text: novel.judul, callback_data: "novel_page_" + novel.judul + "_huruf_" + huruf + "_page_1" }]); // Menambahkan info huruf ke callback

    if (totalPages > 1) {
        let paginationRow = [];
        if (page > 1) {
            paginationRow.push({ text: "Â« Sebelumnya", callback_data: `novel_list_${huruf}_page_${page - 1}` });
        }
        if (page < totalPages) {
            paginationRow.push({ text: "Selanjutnya Â»", callback_data: `novel_list_${huruf}_page_${page + 1}` });
        }
        tombolNovel.push(paginationRow);
    }

    tombolNovel.push([{ text: "Kembali ke Menu Daftar Novel ğŸ“š", callback_data: "daftar_novel" }]); // Tombol Kembali ke Menu Novel
    return { inline_keyboard: tombolNovel };
}

function getNovelPageKeyboard(judulNovel, previousMenu) { // Menambahkan parameter previousMenu
    let novel = null;
    for (const huruf in daftarNovel) {
        novel = daftarNovel[huruf].find(n => n.judul === judulNovel);
        if (novel) break;
    }

    if (!novel) {
        return getMenuNovelKeyboard();
    }

    let keyboard = {
        inline_keyboard: [
            [
                { text: "Telusuri Berkas ğŸ”®", switch_inline_query_current_chat: novel.keyword }
            ],
            [
                { text: "Kembali ke Menu Sebelumnya â†©ï¸", callback_data: previousMenu }, // Tombol Kembali ke Menu Sebelumnya (Dinamis)
            ],
            [
                { text: "Kembali ke Daftar Novel ğŸ“š", callback_data: "daftar_novel" }, // Tombol Kembali ke Menu Daftar Novel
                { text: "Kembali ke Daftar Genre ğŸ­", callback_data: "daftar_genre" }  // Tombol Kembali ke Menu Daftar Genre
            ],

        ]
    };
    return keyboard;
}


function showNovelMenu(chatId, messageId) {
    let menuText = "<b>ğŸ“š Daftar Novel - Pilih Abjad Kegelapan...</b>\n\n<i>Gulir abjad untuk menemukan kisah yang jiwamu cari... ğŸ–¤</i>";
    editMessageText(chatId, messageId, menuText, JSON.stringify(getMenuNovelKeyboard()));
}

function showNovelListPage(chatId, messageId, huruf, page = 1) {
    let listNovelKeyboard = getNovelListKeyboard(huruf, page);
    if (listNovelKeyboard.inline_keyboard.length <= 1 && page === 1) {
        let menuText = `<b>ğŸ“š Daftar Novel - Abjad ${huruf.toUpperCase()} Kosong ğŸ‘»</b>\n\n<i>Tidak ada arwah novel yang bersembunyi di abjad ini... Kembali ke menu utama novel.</i>`;
        editMessageText(chatId, messageId, menuText, JSON.stringify({ inline_keyboard: [[{ text: "Kembali ke Menu Daftar Novel ğŸ“š", callback_data: "daftar_novel" }]] }));
    } else {
        let menuText = `<b>ğŸ“š Daftar Novel - Abjad ${huruf.toUpperCase()} - Halaman ${page} ğŸ–¤</b>\n\n<i>Pilih novel yang memanggil jiwamu dari daftar berikut...</i>`;
        editMessageText(chatId, messageId, menuText, JSON.stringify(listNovelKeyboard));
    }
}

function showNovelListGenrePage(chatId, messageId, genre, page = 1) {
    let listNovelKeyboard = getNovelListGenreKeyboard(genre, page);
    const novelsForGenre = [];
    for (const huruf in daftarNovel) {
        daftarNovel[huruf].forEach(novel => {
            if (novel.genre.includes(genre)) {
                novelsForGenre.push(novel);
            }
        });
    }
    if (listNovelKeyboard.inline_keyboard.length <= 1 && page === 1) {
        let menuText = `<b>ğŸ­ Daftar Novel Genre - ${genre} Kosong ğŸ‘»</b>\n\n<i>Tidak ada arwah novel bergenre ${genre} yang bersembunyi di sini... Kembali ke menu utama genre.</i>`;
        editMessageText(chatId, messageId, menuText, JSON.stringify({ inline_keyboard: [[{ text: "Kembali ke Menu Daftar Genre ğŸ­", callback_data: "daftar_genre" }]] }));
    } else {
        let menuText = `<b>ğŸ­ Daftar Novel Genre - ${genre} - Halaman ${page} ğŸ–¤</b>\n\n<i>Pilih novel yang memanggil jiwamu dari daftar berikut...</i>`;
        editMessageText(chatId, messageId, menuText, JSON.stringify(listNovelKeyboard));
    }
}


function showNovelPage(chatId, messageId, judulNovel, previousMenu) { // Menambahkan parameter previousMenu
    let novel = null;
    for (const huruf in daftarNovel) {
        novel = daftarNovel[huruf].find(n => n.judul === judulNovel);
        if (novel) break;
    }

    if (!novel) {
        kirimPesan(chatId, "Novel tidak ditemukan dalam arsip kegelapan... ğŸ˜ˆ");
        return;
    }

    let novelText = `<b>ğŸ“š ${novel.judul} ğŸ–¤</b>\n\n<b>Genre ğŸ“œ:</b> ${novel.genre}\n\n<b>Sinopsis ğŸ“œ:</b> ${novel.sinopsis}\n\n<i>Jejak kisah dalam kehampaan digital... ğŸ¥€</i>`;
    editMessageText(chatId, messageId, novelText, JSON.stringify(getNovelPageKeyboard(judulNovel, previousMenu))); // Menyertakan previousMenu
}


function cleanUpNovelTitles() {
    const specialCharsRegex = /[~!@#$%^&*()_+{}\[\]:;"'<>,.?/\\|`-]/g;
    const maxLength = 30;

    for (const huruf in daftarNovel) {
        daftarNovel[huruf].forEach(novel => {
            novel.judul = novel.judul.replace(specialCharsRegex, '').trim();
            if (novel.judul.length > maxLength) {
                novel.judul = novel.judul.substring(0, maxLength) + "...";
            }
        });
    }
}

cleanUpNovelTitles();

function showMenuGenre(chatId, messageId, page = 1) { // Fungsi untuk menampilkan menu genre dengan halaman
    let menuText = `<b>ğŸ­ Daftar Genre Novel - Halaman ${page} ğŸ–¤</b>\n\n<i>Pilih genre yang membangkitkan minat jiwamu...</i>`;
    editMessageText(chatId, messageId, menuText, JSON.stringify(getMenuGenreKeyboard(page)));
}
